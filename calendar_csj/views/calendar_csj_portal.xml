<odoo>
    <data>

        <template id="portal_layout_csj" name="Portal layout: appointment menu entry" inherit_id="portal.portal_breadcrumbs" priority="40">
            <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
                <li t-if="page_name == 'appointment' or appointment" t-attf-class="breadcrumb-item #{'active ' if not appointment else ''}">
                    <a t-if="appointment" t-attf-href="/my/appointments?{{ keep_query() }}">Appointmentssss</a>
                    <t t-else="">Appointmentssss</t>
                </li>
                <li t-if="appointment" class="breadcrumb-item active">
                    <t t-esc="appointment.name"/>
                </li>
            </xpath>
        </template>

        <template id="portal_my_home" name="Portal My Home: appointment entries" inherit_id="portal.portal_my_home" priority="40">
            <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
                <t t-if="appointment_count" t-call="portal.portal_docs_entry">
                    <t t-set="title">Appointments</t>
                    <t t-set="url" t-value="'/my/appointments'"/>
                    <t t-set="count" t-value="appointment_count"/>
                </t>
            </xpath>
        </template>

        <template id="portal_my_appointments" name="My Appointments">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs_searchbar" t-value="True"/>

                <t t-call="portal.portal_searchbar">
                    <t t-set="title">Agendamientos</t>
                </t>
                <t t-if="not appointments">
                    <div class="alert alert-warning mt8" role="alert">
                        No hay agendamientos.
                    </div>
                </t>
                <t t-if="appointments" t-call="portal.portal_table">
                  <thead>
                      <tr t-attf-class="{{'thead-light' if not groupby == 'none' else ''}}">
                          <th t-if="groupby == 'none'">Agendamiento ID</th>
                          <th t-else="">Agendamiento ID
                              <!--<em class="font-weight-normal text-muted"><span t-field="tasks[0].sudo().project_id.label_tasks"/> for project:</em>
                              <span t-field="tasks[0].sudo().project_id.name"/>-->
                          </th>
                          <th class="text-center">Número de Proceso</th>
                          <th class="text-left">Tipo</th>
                          <th class="text-left">Fecha de Realización</th>
                          <th class="text-left">Hora de Realización</th>
                          <th class="text-left">Tipo de Solicitud</th>
                          <th class="text-left">Estado</th>
                          <th class="text-left">Tipos de Solicitud</th>
                          <th class="text-left">Código del Despacho</th>
                          <th class="text-left">Despacho Solicitante</th>
                          <th class="text-left">Origen</th>
                          <th class="text-left">Departamento</th>
                          <th class="text-left">Destino</th>
                          <th class="text-left">Medio de Recepción</th>
                          <th class="text-left">Detalles Medio de Recepción</th>
                          <th class="text-left">Fecha de Solicitud</th>
                          <th class="text-left">Nombre del Solicitante</th>
                          <th class="text-left">Correo Solicitante</th>
                          <th class="text-left">Número de Proceso</th>
                          <th class="text-left">Sala</th>
                          <th class="text-left">Correos Participantes</th>
                          <th class="text-left">Lifesize URL</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr t-foreach="appointments" t-as="appointment">
                          <td>
                              <a t-attf-href="/my/appointment/#{appointment.id}?{{ keep_query() }}"><span t-field="appointment.appointment_code"/></a>
                          </td>
                          <td>
                              <span t-field="appointment.process_number"/>
                          </td>
                          <td>
                              <span t-field="appointment.type"/>
                          </td>
                          <td>
                              <span t-field="appointment.calendar_date"/>
                          </td>
                          <td>
                              <span t-field="appointment.request_type"/>
                          </td>
                          <td>
                              <span t-esc="appointment.calendar_time" id="calendar_time"/>
                          </td>
                          <td>
                              <span class="badge badge-pill badge-info" title="Current state of the appointment" t-esc="appointment.state"/>
                          </td>
                          <td>
                              <span t-field="appointment.request_type_label"/>
                          </td>
                          <td>
                              <span t-field="appointment.judged_only_code"/>
                          </td>
                          <td>
                              <span t-field="appointment.judged_only_name"/>
                          </td>
                          <td>
                              <span t-field="appointment.judged_only_name"/>
                          </td>
                          <td>
                              <span t-field="appointment.city_id.name"/>
                          </td>
                          <td>
                              <span t-field="appointment.country_state_id.name"/>
                          </td>
                          <td>
                              <span t-field="appointment.reception_id.name"/>
                          </td>
                          <td>
                              <span t-field="appointment.reception_detail"/>
                          </td>
                          <td>
                              <span t-field="appointment.request_date"/>
                          </td>
                          <td>
                              <span t-field="appointment.applicant_id.name"/>
                          </td>
                          <td>
                              <span t-field="appointment.partner_ids_label"/>
                          </td>
                          <td>
                              <span t-field="appointment.process_number"/>
                          </td>
                          <td>
                              <span t-field="appointment.room_id_mame"/>
                          </td>
                          <td>
                              <span t-field="appointment.partner_ids_label"/>
                          </td>
                          <td>
                              <span t-esc="appointment.lifesize_url"/>
                          </td>
                          <!--<td class="text-right">
                              <a t-attf-href="/my/tasks?{{keep_query(filterby=project.id)}}">
                                  <t t-esc="project.task_count" />
                                  <t t-esc="project.label_tasks" />
                              </a>
                          </td>-->
                      </tr>
                  </tbody>
                </t>
            </t>
        </template>

        <template id="portal_my_appointment" name="My Appointment">
            <t v="portal.portal_layout">
                <t t-set="o_portal_fullwidth_alert" groups="calendar_appointment.group_calendar_manager">
                    <t t-call="portal.portal_back_in_edit_mode">
                        <t t-set="backend_url" t-value="'/web#model=calendar.appointment&amp;id=%s&amp;view_type=form' % (appointment.id)"/>
                    </t>
                </t>

                <t t-call="portal.portal_record_layout">
                    <t t-set="card_header">
                        <div class="row no-gutters">
                            <div class="col-md">
                                <h5 class="mb-1 mb-md-0">
                                    <span>ID Agendamiento: </span>
                                    <span t-field="appointment.appointment_code"/>
                                    <small class="text-muted"> (#<span t-field="appointment.id"/>)</small>
                                </h5>
                            </div>
                            <div class="col-md text-md-right">
                                <small class="text-right">Estado:</small>
                                <span t-field="appointment.state" class=" badge badge-pill badge-info" title="Estado actual del agendamiento"/>
                            </div>
                        </div>
                       
                    </t>
                    <t t-set="card_body">
                        <!--<div class="mb-1" t-if="user.partner_id.id in appointment.sudo().project_id.message_partner_ids.ids">
                            <strong>Project:</strong> <a t-attf-href="/my/project/#{task.project_id.id}" t-field="task.project_id.name"/>
                        </div>-->

                        <div class="mb-1" style="text-align:center;background-color: #00a09d;padding-top:15px;padding-bottom:15px;color:#FFF;">
                            <strong>Despacho:</strong> <span t-field="appointment.partner_id.name"/><br/>
                            <strong>Sala:</strong> <span t-field="appointment.room_id.name"/><br/>
                            <strong>Ciudad:</strong> <span t-field="appointment.city_id.name"/><br/>
                            <strong>Departamento:</strong> <span t-field="appointment.country_state_id.name"/>
                        </div>

                        <div class="row col-12 mb-4" style="padding-top:20px;">
                            <div class="col-6 col-md-6 mb-1" style="border: solid 1px #ccc;margin-left:0px;">
                                <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Datos de Realización</div>
                                <br/>
                                <strong>Fecha y Hora de Realización:</strong> <span t-field="appointment.calendar_datetime" t-options='{"widget": "datetime"}'/>
                                <br/>
                                <strong>Duración:</strong> <span t-field="appointment.calendar_duration" t-options='{"widget": "float_date"}'/>
                                <br/>
                                <strong>Fecha de Agendamiento:</strong> <span t-field="appointment.appointment_date" t-options='{"widget": "date"}'/>
                                <br/>
                                <strong>Fecha de Solicitud:</strong> <span t-field="appointment.request_date" t-options='{"widget": "float_date"}'/>
                                <br/>
                                <strong>Fecha de Cierre:</strong> <span t-field="appointment.appointment_close_date" t-options='{"widget": "float_date"}'/>
                                <br/>
                                <strong>Usuario del Cierre:</strong> <span t-field="appointment.appointment_close_user_id"/>
                            </div>
                            <div class="col-6 col-md-6 mb-1" style="border: solid 1px #ccc;margin-left:0px;" t-if="appointment.calendar_duration">
                              <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Tipo de Agendamiento</div>
                              <br/>
                              <strong>Tipo de Solicitud:</strong> <span t-field="appointment.type"/>
                              <br/>
                              <strong>Clase de Solicitud:</strong> <span t-field="appointment.class_id.name"/>
                              <br/>
                              <strong>Apoyo en Sitio:</strong> <span t-field="appointment.help_id.name"/>
                              <br/>
                              <strong>Tipo de Participante:</strong> <span t-field="appointment.partaker_type"/>
                              <br/>
                              <strong>Tipo de Conexión:</strong> <span t-field="appointment.connection_type"/>
                              <br/>
                              <strong>Medio de Recepción:</strong> <span t-field="appointment.reception_id.name"/>
                              <br/>
                              <strong>Detalles Medio de Recepción:</strong> <span t-field="appointment.reception_detail"/>
                            </div>
                        </div>

                        <div class="row col-12 mb-4" style="padding-top:20px;">
                            <div class="col-6 col-md-6 mb-1" style="border: solid 1px #ccc;margin-left:0px;">
                                <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Datos del Proceso</div>
                                <br/>
                                <strong>Nombre Solicitante:</strong> <span t-field="appointment.applicant_id.name"/>
                                <br/>
                                <strong>Declarante:</strong> <span t-field="appointment.declarant_text"/>
                                <br/>
                                <strong>Procesado:</strong> <span t-field="appointment.indicted_text"/>
                                <br/>
                                <strong>Tipo de Audiencia:</strong> <span t-field="appointment.request_type"/>
                                <br/>
                                <strong>Número de Proceso:</strong> <span t-field="appointment.process_number"/>
                                <br/>
                                <strong>Etiqueta:</strong> <span t-field="appointment.tag_number"/>
                            </div>
                            <div class="col-6 col-md-6 mb-1" style="border: solid 1px #ccc;margin-left:0px;" t-if="appointment.calendar_duration">
                              <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Datos de Reunión</div>
                              <br/>
                              <strong>Extensión Lifesize:</strong> <span t-field="appointment.lifesize_meeting_ext"/>
                              <br/>
                              <strong>URL Lifesize:</strong> <span t-field="appointment.lifesize_url"/>
                              <br/>
                              <strong>API Lifesize:</strong> <span t-field="appointment.name"/>
                              <br/>
                              <strong>Record Data:</strong> <span t-field="appointment.record_data"/>
                            </div>
                        </div>

                        <div class="row col-12 mb-4" style="padding-top:20px;">
                          <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Observaciones</div>
                          <br/>
                          <br/>
                          <span t-field="appointment.observations"/>
                        </div>

                        <div class="row col-12 mb-4" style="padding-top:20px;">
                          <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Datos del solicitante</div>
                          <br/>
                          <strong>Email:</strong> <span t-field="appointment.applicant_email"/>
                          <br/>
                          <strong>Dominio:</strong> <span t-field="appointment.applicant_domain"/>
                          <br/>
                          <strong>Teléfono:</strong> <span t-field="appointment.applicant_mobile"/>
                        </div>


                        <div class="row col-12 mb-4" style="padding-top:20px;">
                          <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Invitados</div>
                          <br/>

                        </div>

                        <div class="row col-12 mb-4" style="padding-top:20px;">
                          <div style="font-weight:bold;border-left: solid 4px #875a7b;width:100%;text-align:center;color:#00A09D;">Destinos</div>
                          <br/>
                        </div>
                    </t>
                </t>

                <div class="mt32">
                    <h4><strong>Historia de Mensajes y Comunicación sobre este Agendamiento</strong></h4>
                    <t t-call="portal.message_thread">
                        <t t-set="object" t-value="appointment"/>
                        <t t-set="pid" t-value="pid"/>
                        <t t-set="hash" t-value="hash"/>
                    </t>
                </div>
            </t>
        </template>
        
        <template id="portal_searchbar" name="Portal Search Bar">
        <nav t-attf-class="navbar navbar-light navbar-expand-lg border py-0 mb-2 o_portal_navbar {{classes if classes else ''}} {{'mt-3 rounded' if breadcrumbs_searchbar else 'border-top-0' }}">
            <!--  Navbar breadcrumb or title  -->
            <t t-if="breadcrumbs_searchbar">
                <t t-call="portal.portal_breadcrumbs"/>
            </t>
            <span t-else="" class="navbar-brand mb-0 h1 mr-auto" t-esc="title or 'No title'"/>

            <!--  Collapse button -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#o_portal_navbar_content" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle filters">
                <span class="navbar-toggler-icon small"/>
            </button>

            <!--  Collapsable content  -->
            <div class="collapse navbar-collapse" id="o_portal_navbar_content">
                <div class="nav flex-column flex-lg-row ml-auto p-0 mb-3 mb-lg-0 mt-1 mt-lg-0">
                    <div t-if="searchbar_sortings" class="form-inline">
                        <span class="small mr-1 navbar-text">Sort By:</span>
                        <div class="btn-group">
                            <button id="portal_searchbar_sortby" data-toggle="dropdown" class="btn btn-secondary btn-sm dropdown-toggle">
                                <t t-esc="searchbar_sortings[sortby].get('label', 'Newest')"/>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="portal_searchbar_sortby">
                                <t t-foreach="searchbar_sortings" t-as="option">
                                    <a t-att-href="request.httprequest.path + '?' + keep_query('*', sortby=option)"
                                       t-attf-class="dropdown-item#{sortby == option and ' active' or ''}">
                                        <span t-esc="searchbar_sortings[option].get('label')"/>
                                    </a>
                                </t>
                            </div>
                        </div>
                    </div>
                    <div t-if="searchbar_filters" class="form-inline ml-lg-2">
                        <span class="small mr-1 navbar-text">Filter By:</span>
                        <div class="btn-group">
                            <button id="portal_searchbar_filters" data-toggle="dropdown" class="btn btn-secondary btn-sm dropdown-toggle">
                                <t t-esc="searchbar_filters[filterby].get('label', 'All')"/>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="portal_searchbar_filters">
                                <t t-foreach="searchbar_filters" t-as="option">
                                    <a t-att-href="default_url + '?' + keep_query('*', filterby=option)"
                                       t-attf-class="dropdown-item#{filterby == option and ' active' or ''}">
                                        <span t-esc="searchbar_filters[option].get('label')"/>
                                    </a>
                                </t>
                            </div>
                        </div>
                    </div>
                    <div t-if="searchbar_groupby" class="form-inline ml-lg-2">
                        <span class="small mr-1 navbar-text">Group By:</span>
                        <div class="btn-group">
                            <button id="portal_searchbar_groupby" data-toggle="dropdown" class="btn btn-secondary btn-sm dropdown-toggle">
                                <t t-esc="searchbar_groupby[groupby].get('label', 'None')"/>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="portal_searchbar_groupby">
                                <t t-foreach="searchbar_groupby" t-as="option">
                                    <a t-att-href="default_url + '?' + keep_query('*', groupby=option)"
                                       t-attf-class="dropdown-item#{groupby == option and ' active' or ''}">
                                        <span t-esc="searchbar_groupby[option].get('label')"/>
                                    </a>
                                </t>
                            </div>
                        </div>
                    </div>
                    <t t-raw="0"/>
                </div>
                <form t-if="searchbar_inputs" class="form-inline o_portal_search_panel ml-lg-4">
                    <div class="input-group input-group-sm w-100">
                        <div class="input-group-prepend">
                            <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown"/>
                            <div class="dropdown-menu" role="menu">
                                <t t-foreach='searchbar_inputs' t-as='input'>
                                    <a t-att-href="'#' + searchbar_inputs[input]['input']"
                                        t-attf-class="dropdown-item#{search_in == searchbar_inputs[input]['input'] and ' active' or ''}">
                                        <span t-raw="searchbar_inputs[input]['label']"/>
                                    </a>
                                </t>
                            </div>
                        </div>
                        <input type="text" class="form-control form-control-sm" placeholder="Search" t-att-value='search' name="search"/>
                        <span class="input-group-append">
                            <button class="btn btn-secondary search-submit" type="button">
                                <span class="fa fa-search"/>
                            </button>
                        </span>
                    </div>
                </form>
            </div>
        </nav>
        </template>
    </data>
</odoo>
